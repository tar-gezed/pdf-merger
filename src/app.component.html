<main class="container mx-auto p-4 md:p-8 max-w-4xl">
  
  <header class="text-center mb-8">
    <h1 class="text-4xl md:text-5xl font-bold text-slate-800 mb-2">Offline PDF Merger</h1>
    <p class="text-slate-600 max-w-2xl mx-auto">
      Combine your PDF files securely in your browser. Your files are never uploaded to any server.
    </p>
  </header>

  <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
    
    <!-- File Upload / Drop Zone -->
    <div 
      (dragenter)="handleDragEnter($event)" 
      (dragleave)="handleDragLeave($event)" 
      (dragover)="handleDragOver($event)" 
      (drop)="handleDropOnZone($event)"
      [class.drag-over]="isDraggingOver()"
      class="relative border-2 border-dashed border-slate-300 rounded-xl p-8 text-center transition-colors duration-300">
      
      <input 
        type="file" 
        multiple 
        accept="application/pdf" 
        (change)="onFileSelect($event)"
        class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
        id="file-upload">
      
      <label for="file-upload" class="flex flex-col items-center justify-center space-y-4 cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
        </svg>
        <p class="text-slate-700 font-semibold">
          Drag & drop your PDF files here
        </p>
        <p class="text-sm text-slate-500">
          or <span class="text-blue-600 font-medium">click to browse</span>
        </p>
      </label>
    </div>

    <!-- Error Message -->
    @if (errorMessage()) {
      <div class="mt-4 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md" role="alert">
        <p>{{ errorMessage() }}</p>
      </div>
    }

    <!-- File List -->
    @if (files().length > 0) {
      <div class="mt-6">
        <h2 class="text-lg font-semibold text-slate-800 mb-3">Files to Merge ({{ files().length }})</h2>
        <p class="text-sm text-slate-500 mb-4">Drag and drop to reorder the files.</p>
        
        <ul class="space-y-3">
          @for (file of files(); track file; let i = $index) {
            <li 
              draggable="true" 
              (dragstart)="handleDragStart($event, i)"
              (dragend)="handleDragEnd($event)"
              (dragover)="handleDragOver($event)"
              (drop)="handleDropOnList($event, i)"
              class="flex items-center justify-between bg-slate-50 border border-slate-200 p-3 rounded-lg cursor-grab transition-shadow hover:shadow-md">
              
              <div class="flex items-center space-x-3 overflow-hidden">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-slate-400 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
                <div class="flex-grow min-w-0">
                  <p class="text-slate-800 font-medium truncate" [title]="file.name">{{ file.name }}</p>
                  <p class="text-xs text-slate-500">{{ formatBytes(file.size) }}</p>
                </div>
              </div>

              <button (click)="removeFile(i)" title="Remove file" class="ml-4 flex-shrink-0 p-1.5 rounded-full text-slate-500 hover:bg-red-100 hover:text-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </li>
          }
        </ul>

        <!-- Action Buttons -->
        <div class="mt-8 pt-6 border-t border-slate-200 flex flex-col sm:flex-row items-center justify-between gap-4">
          <button (click)="clearFiles()" class="w-full sm:w-auto px-6 py-2.5 text-sm font-semibold text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500">
            Clear All
          </button>
          <button 
            (click)="mergeAndDownload()" 
            [disabled]="isMerging() || files().length < 2"
            class="w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 text-base font-semibold text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors">
            @if (isMerging()) {
              <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <span>Merging...</span>
            } @else {
              <span>Merge {{ files().length }} PDFs</span>
            }
          </button>
        </div>
        @if (files().length < 2) {
           <p class="text-center text-sm text-slate-500 mt-2">Please add at least two files to enable merging.</p>
        }
      </div>
    }
  </div>

  <footer class="text-center mt-12 text-sm text-slate-500">
    <p>&copy; {{ currentYear }} Offline PDF Merger. All processing is done locally.</p>
  </footer>
</main>